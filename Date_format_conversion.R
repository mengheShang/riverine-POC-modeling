library(lubridate)
library(openxlsx)
library(readxl)

dates <- c("2015/9/30", "2015/9/30", "2015/10/1", "2015/10/1", "2015/10/2", "2015/10/2", "2015/10/1",
           "2015/10/1", "2015/10/1", "2015/10/1", "2015/10/2", "2015/10/2", "2015/10/2", "2015/10/3",
           "2015/10/3", "2015/10/3", "2015/10/3", "2015/10/3", "2015/10/4", "2015/10/4", "2015/10/4",
           "2015/10/4", "2015/10/4", "2015/10/5", "2015/10/5", "2015/10/5", "2015/10/5", "2015/10/5",
           "2015/10/5", "2015/10/5", "2015/10/5", "2015/10/5", "2015/10/6", "2015/10/6", "2015/10/6",
           "2015/10/6", "2015/10/14", "2015/10/14", "2015/10/9", "2015/10/10", "2015/10/10", "2015/10/10",
           "2015/10/10", "2015/10/10", "2015/10/10", "2015/10/10", "2015/10/10", "2015/10/9", "2015/10/11",
           "2015/10/11", "2015/10/11", "2015/10/11", "2015/10/1", "2015/10/3", "2015/10/3", "2015/10/9",
           "2015/10/9", "2015/10/9", "2015/10/9")


# 转换为字符型以避免非字符串输入
dates <- as.character(dates)

# 指定可能的日期格式
date_formats <- c("Y/m/d")

# 使用parse_date_time尝试解析日期
parsed_dates <- parse_date_time(dates, orders = date_formats)

# 转换为YYYY-MM-DD格式的字符型
dates_text <- format(parsed_dates, "%Y-%m-%d")

# 创建数据框
dates_df <- data.frame(Date = dates_text)

# 将数据框保存到Excel文件
write.xlsx(dates_df, "D:\\POC research\\data\\dates.xlsx")


